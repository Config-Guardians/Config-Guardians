name: Config-Guardians

services:
  hachiware:
    container_name: hachiware
    image: zachareee/hachiware
    build: ./hachiware
    develop:
      watch:
        - path: ./hachiware
          action: sync
          target: /app
    ports:
      - 4000:4000
    environment:
      SIDECAR_HOST: steampipe:8080
      DATABASE_URL: postgres://postgres:postgres@hachiware-db:5432/postgres
      STEAMPIPE_DATABASE_URL: postgres://steampipe:password@steampipe:9193/steampipe
    depends_on:
      - steampipe
      - hachiware-db
  steampipe:
    container_name: steampipe
    build: ./steampipe
    image: zachareee/steampipe-sidecar
    develop:
      watch:
        - path: ./steampipe
          action: rebuild
    ports:
      - 8080:8080
      # - 9193:9193
  hachiware-db:
    container_name: hachiware-db
    image: postgres:17.6
    environment:
      - POSTGRES_PASSWORD=postgres
